<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Input impossible à remplir</title>
  </head>
  <body
    style="
      display: flex;
      flex-direction: column;
      height: 100vh;
      margin: 0;
      justify-content: center;
      align-items: center;
    "
  >
    <textarea
      id="impossibleInput"
      style="min-height: 200px; width: 500px; margin: 10px"
    ></textarea>
    <button style="margin: 10px" id="mainButton">
      Soumettre votre réponse
    </button>

    <script src="replace.js"></script>
    <script src="ping.js"></script>
    <script src="captcha.js"></script>
    <script src="annoyingEngine.js"></script>
    <script src="flee.js"></script>
    <script src="duplicateButton.js"></script>
    <script src="brokenKeyboard.js"></script>
    <script>
      let wordList;
      annoyingEngine();

      function initWordList() {
        fetch("mots.txt")
          .then((response) => response.text())
          .then((text) => {
            wordList = text.split("\n");
          });
      }

      initWordList();

      document.addEventListener("keydown", (e) => {
        // Annoying backspace
        if (e.key === "Backspace") {
          if (Math.random() < 0.4) e.preventDefault();
        }

        // Check if word is in the dictionnary
        if (e.key === " " || e.key === "Enter") {
          const lastWord = document
            .getElementById("impossibleInput")
            .replace("\n", " ")
            .value.split(" ")
            .pop()
            .replace(/[^a-zA-Zéàèêçù]/g, "");
          if (!wordList.includes(lastWord.toLowerCase())) {
            alert(
              "Ce mot n'existe pas dans notre dictionnaire\nVeuillez en choisir un autre"
            );
            document.getElementById("impossibleInput").value = document
              .getElementById("impossibleInput")
              .value.replace(lastWord, "");
          }
        }
      });
    </script>
  </body>
</html>
